"use strict";function lolcation(e){e=e||global.location||{};var o,t={},s=typeof e;if("blob:"===e.protocol)t=new URL(unescape(e.pathname),{});else if("string"===s){t=new URL(e,{});for(o in ignore)delete t[o]}else if("object"===s){for(o in e)o in ignore||(t[o]=e[o]);void 0===t.slashes&&(t.slashes=slashes.test(e.href))}return t}function extractProtocol(e){var o=protocolre.exec(e);return{protocol:o[1]?o[1].toLowerCase():"",slashes:!!o[2],rest:o[3]}}function resolve(e,o){for(var t=(o||"/").split("/").slice(0,-1).concat(e.split("/")),s=t.length,r=t[s-1],a=!1,n=0;s--;)"."===t[s]?t.splice(s,1):".."===t[s]?(t.splice(s,1),n++):n&&(0===s&&(a=!0),t.splice(s,1),n--);return a&&t.unshift(""),("."===r||".."===r)&&t.push(""),t.join("/")}function URL(e,o,t){if(!(this instanceof URL))return new URL(e,o,t);var s,r,a,n,l,i,h=rules.slice(),c=typeof o,p=this,u=0;for("object"!==c&&"string"!==c&&(t=o,o=null),t&&"function"!=typeof t&&(t=qs.parse),o=lolcation(o),r=extractProtocol(e||""),s=!r.protocol&&!r.slashes,p.slashes=r.slashes||s&&o.slashes,p.protocol=r.protocol||o.protocol||"",e=r.rest,r.slashes||(h[2]=[/(.*)/,"pathname"]);u<h.length;u++)n=h[u],a=n[0],i=n[1],a!==a?p[i]=e:"string"==typeof a?~(l=e.indexOf(a))&&("number"==typeof n[2]?(p[i]=e.slice(0,l),e=e.slice(l+n[2])):(p[i]=e.slice(l),e=e.slice(0,l))):(l=a.exec(e))&&(p[i]=l[1],e=e.slice(0,l.index)),p[i]=p[i]||(s&&n[3]?o[i]||"":""),n[4]&&(p[i]=p[i].toLowerCase());t&&(p.query=t(p.query)),s&&o.slashes&&"/"!==p.pathname.charAt(0)&&(""!==p.pathname||""!==o.pathname)&&(p.pathname=resolve(p.pathname,o.pathname)),required(p.port,p.protocol)||(p.host=p.hostname,p.port=""),p.username=p.password="",p.auth&&(n=p.auth.split(":"),p.username=n[0]||"",p.password=n[1]||""),p.origin=p.protocol&&p.host&&"file:"!==p.protocol?p.protocol+"//"+p.host:"null",p.href=p.toString()}function set(e,o,t){var s=this;switch(e){case"query":"string"==typeof o&&o.length&&(o=(t||qs.parse)(o)),s[e]=o;break;case"port":s[e]=o,required(o,s.protocol)?o&&(s.host=s.hostname+":"+o):(s.host=s.hostname,s[e]="");break;case"hostname":s[e]=o,s.port&&(o+=":"+s.port),s.host=o;break;case"host":s[e]=o,/:\d+$/.test(o)?(o=o.split(":"),s.port=o.pop(),s.hostname=o.join(":")):(s.hostname=o,s.port="");break;case"protocol":s.protocol=o.toLowerCase(),s.slashes=!t;break;case"pathname":case"hash":if(o){var r="pathname"===e?"/":"#";s[e]=o.charAt(0)!==r?r+o:o}else s[e]=o;break;default:s[e]=o}for(var a=0;a<rules.length;a++){var n=rules[a];n[4]&&(s[n[1]]=s[n[1]].toLowerCase())}return s.origin=s.protocol&&s.host&&"file:"!==s.protocol?s.protocol+"//"+s.host:"null",s.href=s.toString(),s}function toString(e){e&&"function"==typeof e||(e=qs.stringify);var o,t=this,s=t.protocol;s&&":"!==s.charAt(s.length-1)&&(s+=":");var r=s+(t.slashes?"//":"");return t.username&&(r+=t.username,t.password&&(r+=":"+t.password),r+="@"),r+=t.host+t.pathname,o="object"==typeof t.query?e(t.query):t.query,o&&(r+="?"!==o.charAt(0)?"?"+o:o),t.hash&&(r+=t.hash),r}var required=require("requires-port"),qs=require("querystringify"),protocolre=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,slashes=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,rules=[["#","hash"],["?","query"],["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],ignore={hash:1,query:1};URL.prototype={set:set,toString:toString},URL.extractProtocol=extractProtocol,URL.location=lolcation,URL.qs=qs,module.exports=URL;